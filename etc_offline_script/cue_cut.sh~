#!/bin/bash

# Script to cut and edit school library cue block from USITT ASCII file
# NOTE: Needs echo, cat and sed installed

# File and text variables
ext_csv=csv
ext_text=txt

input_file=${1}
output_file=${input_file%.$ext_csv}.${ext_text}

dance_piece=${input_file#*raw_etc_}
dance_piece=${dance_piece%*.asc}

replace_text="LIBRARY CUES"

# check input file exists (exit if not)
if [ ! -f ${input_file} ]; then
    /bin/echo "${input_file} not found!";
    exit 1;

else
	/bin/echo "${input_file} found. Attempting cue block cut to ${output_file}";
	
	# use sed to cut cue block from input file and stick in variable
	cue_data=$(cat ${input_file} | sed -n '/^Cue 900/,/^! Groups/p' | sed -e  's/! Groups//');
	
	# replace cue 900 text with partial filename, name of dance
	cue_data=$(echo "${cue_data}" | sed -e 's/LIBRARY CUES/ballsack/');
	
	# redirect as output file
#	echo ${dance_piece}
	echo "${cue_data}"
#	echo ${cue_data} > ${output_file}

	#	/bin/echo "AUTOMATED CONVERSION TO TEXT FILE" > ${output_file}

fi
